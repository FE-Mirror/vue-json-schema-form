/** @license @lljj/vue3-form-naive (c) 2020-2023 Liu.Jun License: Apache-2.0 */
import{h as e,ref as t,getCurrentInstance as r,defineComponent as n,onMounted as o}from"vue";import a from"@lljj/vue3-form-core";export{SchemaField,fieldProps}from"@lljj/vue3-form-core";export{default as i18n}from"@lljj/vjsf-utils/i18n";import{modelValueComponent as i,resolveComponent as l}from"@lljj/vjsf-utils/vue3Utils";import*as u from"@lljj/vjsf-utils/vue3Utils";export{u as vueUtils};import*as m from"@lljj/vjsf-utils/formUtils";export{m as formUtils};import*as d from"@lljj/vjsf-utils/schema/validate";export{d as schemaValidate};export{default as getDefaultFormState}from"@lljj/vjsf-utils/schema/getDefaultFormState";function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var g={CheckboxesWidget:i({name:"CheckboxesWidget",props:{enumOptions:{default:function(){return[]},type:[Array]}},setup:function(t,r){var n=r.attrs;return function(){return e(l("n-checkbox-group"),n,{default:function(){return e(l("n-space"),{itemStyle:"display: flex"},{default:function(){return t.enumOptions.map((function(t,r){return e(l("n-checkbox"),{key:r,value:t.value},{default:function(){return t.label}})}))}})}})}}},{model:"value"}),RadioWidget:i({name:"RadioWidget",props:{enumOptions:{default:function(){return[]},type:[Array]}},setup:function(t,r){var n=r.attrs;return function(){return e(l("n-radio-group"),n,{default:function(){return t.enumOptions.map((function(t,r){return e(l("n-radio"),{key:r,value:t.value},{default:function(){return t.label}})}))}})}}},{model:"value"}),SelectWidget:i({name:"SelectWidget",props:{enumOptions:{default:function(){return[]},type:[Array]}},setup:function(t,r){var n=r.attrs;return function(){return e(l("n-select"),p({options:t.enumOptions},n))}}},{model:"value"}),TimePickerWidget:{name:"TimePickerWidget",inheritAttrs:!1,setup:function(t,r){var n=r.attrs;return function(){var t=n.modelValue,r=n["onUpdate:modelValue"],o=c(n,["modelValue","onUpdate:modelValue"]);return e(l("n-time-picker"),p(p({},o),{},{valueFormat:"HH:mm:ss",formattedValue:t,onUpdateFormattedValue:r}))}}},DatePickerWidget:{name:"DatePickerWidget",inheritAttrs:!1,setup:function(t,r){var n=r.attrs;return function(){var t=n.isNumberValue,r=n.isRange,o=n.modelValue,a=n["onUpdate:modelValue"],i=c(n,["isNumberValue","isRange","modelValue","onUpdate:modelValue"]),u=r&&o&&0===o.length?null:o;return e(l("n-date-picker"),p(p({type:r?"daterange":"date"},i),t?{value:u,onUpdateValue:a}:{valueFormat:t?"T":"yyyy-MM-dd",formattedValue:u,onUpdateFormattedValue:a}))}}},DateTimePickerWidget:{name:"DatePickerWidget",inheritAttrs:!1,setup:function(t,r){var n=r.attrs;return function(){var t=n.isNumberValue,r=n.isRange,o=n.modelValue,a=n["onUpdate:modelValue"],i=c(n,["isNumberValue","isRange","modelValue","onUpdate:modelValue"]),u=r&&o&&0===o.length?null:o;return e(l("n-date-picker"),p(p({type:r?"datetimerange":"datetime"},i),t?{value:u,onUpdateValue:a}:{valueFormat:t?"T":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",formattedValue:u,onUpdateFormattedValue:a}))}}},UploadWidget:{name:"UploadWidget",props:{modelValue:{default:null,type:[String,Array]},responseFileUrl:{default:function(){return function(e){return e?e.url||e.data&&e.data.url:""}},type:[Function]},btnText:{type:String,default:"点击上传"},slots:{type:null,default:null}},setup:function(n,o){var a=o.attrs,i=o.emit,u=n.modelValue,m=Array.isArray(u),d=a.fileList||(m?u.map((function(e,t){return{id:String(t),status:"finished",name:"已上传文件（".concat(t+1,"）"),url:e}})):u?[{id:"1",status:"finished",name:"已上传文件",url:u}]:[]),f=t(d),s=r().appContext.config.globalProperties;return function(){a["onUpdate:modelValue"];var t=c(a,["onUpdate:modelValue"]),r=p(p({fileList:f.value,"on-error":function(){s.$message&&s.$message.error("文件上传失败")}},t),{},{"onUpdate:fileList":function(e){!function(e){var t;if(m)t=e.length?e.reduce((function(e,t){var r=t.url;return r&&e.push(r),e}),[]):[];else{var r=e[e.length-1],n=r&&r.url;n&&(t=n)}i("update:modelValue",t)}(e)},"on-change":function(e){var t=e.fileList;f.value=t},"on-finish":function(e){var t=e.file,r=e.event;return t.url=function(e){var t={};try{t=JSON.parse(e.response)}catch(e){}return n.responseFileUrl(t)||t.url||""}(r.target),t}});m||(r.max=1);var o=p({default:function(){return e(l("n-button"),{type:"primary"},{default:function(){return n.btnText}})}},n.slots||{});return e(l("n-upload"),r,o)}}},InputWidget:i("n-input"),ColorWidget:i("n-color-picker"),TextAreaWidget:i("n-textarea"),InputNumberWidget:i("n-input-number"),AutoCompleteWidget:i("n-auto-complete"),SliderWidget:i("n-slider"),RateWidget:i("n-rate"),SwitchWidget:i("n-switch")},v=g.InputNumberWidget,b={types:{boolean:g.SwitchWidget,string:g.InputWidget,number:v,integer:v},formats:{color:g.ColorWidget,time:g.TimePickerWidget,date:g.DatePickerWidget,"date-time":g.DateTimePickerWidget},common:{select:g.SelectWidget,radioGroup:g.RadioWidget,checkboxGroup:g.CheckboxesWidget},widgetComponents:g};!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".genFromComponent .n-form-item-blank{-ms-flex-wrap:wrap;flex-wrap:wrap}.genFromComponent .n-form-item.n-form-item--top-labelled{grid-template-rows:none}.genFromComponent .formFooter_item .n-form-item-blank{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.genFromComponent .n-form-item-feedback--error .n-form-item-feedback__line{display:-webkit-box!important;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;white-space:normal;text-align:left;line-height:1.2;font-size:12px}.genFromComponent .validateWidget .n-form-item-blank,.genFromComponent .validateWidget .n-form-item-feedback-wrapper{min-height:auto}");var y={WIDGET_MAP:b,COMPONENT_MAP:{form:n({inheritAttrs:!1,setup:function(r,n){var a=n.attrs,i=n.slots,u={top:{labelAlign:"left",labelPlacement:"top"},left:{labelAlign:"left",labelPlacement:"left"},right:{labelAlign:"right",labelPlacement:"left"}},m=t(null);return a.setFormRef&&o((function(){m.value.$$validate=function(e){m.value.validate((function(t){return t?e(!1,t):e(!0)}))},a.setFormRef(m.value)})),function(){a.setFormRef;var t=a.labelPosition,r=a.model,n=c(a,["setFormRef","labelPosition","model"]);return e(l("n-form"),p(p({ref:m,model:r.value},u[t||"top"]),n),i)}}}),formItem:n({inheritAttrs:!1,setup:function(t,r){var n=r.attrs,o=r.slots;return function(){var t=n.prop,r=n.rules,a=p(p({},c(n,["prop","rules"])),{},{path:t,rule:(r||[]).map((function(e){return{trigger:e.trigger,asyncValidator:function(t,r,n){return e.validator(t,r,n)}}}))});return e(l("n-form-item"),a,o)}}}),button:"n-button",popover:n({setup:function(t,r){var n=r.attrs,o=r.slots;return function(){return e(l("n-popover"),n,{trigger:o.reference,default:o.default})}}})},HELPERS:{}},h=a(y),j=i;export default h;export{y as globalOptions,j as modelValueComponent};
